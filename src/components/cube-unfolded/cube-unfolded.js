import './cube-unfolded.css';
import html2element from '/html2element.js';

export default class {
	constructor({onStickerClick, getSelectedColor}) {
		this._state = {
			stickerValues: 'urfuflubrulbdfrdlfdrbdbl'.split('')
		};

		this.element = html2element(`
			<div class="cube-unfolded">
				<svg viewBox="0 0 757.04 478.76" preserveAspectRatio="xMidYMid" xmlns="http://www.w3.org/2000/svg">
					<g transform="translate(-39.990182,4.76584)">
						<path data-idx=0  class="sticker" d="m317.34,134.76c3.2608-15.854,6.4854-31.533,9.6727-47.029,0.5374-2.6127,0.4997-3.8799,3.1316-6.0223s6.7202-1.8036,10.84-1.7974c24.999,0.03744,49.723,0.07421,74.157,0.111,4.1199,0.006,8.37-0.15746,10.506,1.7604,2.1366,1.9178,1.8531,3.5825,1.8531,6.2446v47.919c0,2.6622,0.4538,3.9687-2.0384,6.0964-2.4921,2.1277-7.2761,1.7789-11.933,1.7233-28.26-0.33732-56.209-0.67093-83.83-1.0006-4.6572-0.0556-8.1536,0.16558-10.896-1.7973-2.742-1.9629-2.0013-3.5947-1.4639-6.2075z"/>
						<path data-idx=1  class="sticker" d="m449.03,161.53c3.1187-3.1354,6.3423-2.7526,10.726-2.9157,26.603-0.9901,52.914-1.9693,78.916-2.937,4.3842-0.16316,7.1248-0.7349,10.131,2.405,3.0058,3.1398,2.3269,5.6896,1.9793,9.9816-2.1097,26.044-4.1951,51.801-6.2572,77.256-0.3476,4.292-0.1625,7.7478-3.1711,10.748-3.0085,2.9999-6.2287,2.7809-10.407,3.1073-25.355,1.9802-50.431,3.9386-75.213,5.874-4.1785,0.32634-7.4927,0.90077-9.9816-1.3195-2.489-2.2203-2.2702-6.6118-2.1283-11.067,0.86101-27.034,1.7124-53.77,2.554-80.193,0.1418-4.4552-0.2668-7.8038,2.8518-10.939z"/>
						<path data-idx=2  class="sticker" d="m317.63,161.11c3.1907-3.2472,6.6691-2.7547,11.371-2.6917,28.53,0.38272,56.746,0.7612,84.631,1.1353,4.7018,0.0631,8.8353-0.20888,11.664,2.8748,2.8286,3.0836,2.2624,6.1523,2.1729,10.571-0.5438,26.814-1.0799,53.333-1.6114,79.541-0.09,4.419,0.3977,7.7799-2.8076,10.864-3.2052,3.0844-6.4127,2.2298-10.889,2.1484-27.16-0.49382-54.02-0.9822-80.566-1.4648-4.476-0.0814-8.0223,0.28718-10.986-2.5391-2.964-2.8262-2.714-6.5064-2.8503-10.907-0.8271-26.703-1.6452-53.112-2.4536-79.211-0.1363-4.4006-0.8653-7.0738,2.3254-10.321z"/>
						<path data-idx=3  class="sticker" d="m191.76,140.65c-2.8105-1.4446-1.3068-4.0371-0.1271-6.656,7.1588-15.891,14.238-31.608,21.236-47.14,1.1797-2.6189,1.5583-4.2949,4.4657-6.152,2.9074-1.857,7.1279-1.6183,11.155-1.575,24.437,0.26224,48.605,0.52197,72.49,0.77826,4.0272,0.0432,7.2563-0.0132,9.4926,1.2849s1.2919,4.095,0.6433,6.72c-3.9352,15.929-7.8277,31.682-11.674,47.252-0.6486,2.6251-0.4457,3.6508-3.3169,5.874-2.8713,2.2232-7.7456,1.9024-12.304,1.853-27.66-0.29992-55.016-0.59623-82.051-0.88944-4.5584-0.0494-7.1984,0.0956-10.009-1.349z"/>
						<path data-idx=4  class="sticker" d="m189.55,159.25c2.7848-2.6451,6.1524-2.3437,10.742-2.2949,29.972,0.3187,55.918,0.59509,82.617,0.87892,4.5899,0.0488,7.971-0.25155,11.182,2.8809,3.2106,3.1324,2.8971,6.0221,3.0517,10.4,0.9252,26.2,1.9272,54.567,2.7832,78.809,0.1546,4.3783,0.8988,7.7342-1.9775,10.596-2.8763,2.8615-6.2663,2.3275-10.62,2.2217-26.054-0.63311-54.262-1.3185-78.369-1.9043-4.3538-0.10579-7.8374,0.16333-11.011-2.8076-3.1734-2.9709-2.8321-6.1524-3.2227-10.474-2.3375-25.859-4.8685-53.857-7.0312-77.783-0.3907-4.3213-0.9293-7.8774,1.8554-10.522z"/>
						<path data-idx=5  class="sticker" d="m110,146.4c1.4358-1.0878,3.5644-0.41934,6.2115,0,16.062,2.5445,31.948,5.0611,47.648,7.5481,2.6471,0.41934,5.1462,0.82741,6.8929,2.6995s1.8783,7.1812,2.2933,11.493c2.5177,26.161,5.0086,52.034,7.4694,77.604,0.415,4.3114,1.343,10.014-0.4324,11.047s-3.5032,0.22714-6.0935-0.60281c-15.718-5.036-31.263-10.017-46.625-14.939-2.5903-0.82994-4.9194-1.578-6.4867-3.4858-1.5672-1.9077-2.2278-6.8056-2.6995-10.706-2.8626-23.669-5.6937-47.078-8.4916-70.213-0.47176-3.9007-1.1212-9.3564,0.31451-10.444z"/>
						<path data-idx=6  class="sticker" d="m333.1,70.129c-2.6141-0.72986-1.8256-3.267-1.4282-5.2673,2.4116-12.138,4.7971-24.142,7.1541-36.006,0.3975-2.0004,0.265-2.5324,2.4502-4.3239s5.9661-1.6684,9.5781-1.664c21.917,0.02535,43.594,0.05409,65.016,0.0786,3.6119,0.004,6.841-0.21962,9.0539,1.2186s1.8694,2.7865,1.913,4.7825c0.2664,12.111,0.52545,24.09,0.7862,35.928,0.044,1.996,0.5168,3.721-1.8606,5.1494s-6.1146,0.83858-10.168,0.83858c-24.594,0.000041-48.917-0.000055-72.956,0-4.0531,0-6.9246-0.004-9.5388-0.73373z"/>
						<path data-idx=7  class="sticker" d="m679.35,150.59c2.0546-2.0644,3.3484-2.0715,5.7037-2.4262,14.292-2.1524,28.426-4.281,42.395-6.3848,2.3553-0.35471,4.1186-0.51691,5.3207,0.97901,1.202,1.4959,0.4682,5.5335-0.1703,9.3218-3.8743,22.987-7.7058,45.722-11.493,68.19-0.6385,3.7883-0.8616,7.8717-2.937,10.216-2.0754,2.344-3.6181,2.5256-5.9379,3.2137-14.076,4.1756-27.998,8.3052-41.757,12.387-2.3198,0.68814-3.6194,1.5387-5.2568,0.10641-1.6375-1.4323-0.4966-6.2855,0.1064-10.407,3.659-25.01,7.2778-49.746,10.854-74.191,0.6031-4.1218,1.1166-8.9388,3.1712-11.003z"/>
						<path data-idx=8  class="sticker" d="m569.62,157.02c3.029-2.8917,5.8741-2.6532,9.9603-2.8093,24.795-0.94702,49.318-1.8837,73.553-2.8093,4.0863-0.15607,7.3611-0.67339,9.6623,1.7452s1.4614,6.0301,0.8939,10.152c-3.444,25.01-6.8494,49.746-10.216,74.191-0.5675,4.1218-0.6464,7.6443-3.5755,10.407-2.9291,2.7629-5.8882,2.5681-9.7687,2.8732-23.547,1.851-46.835,3.6817-69.85,5.4909-3.8805,0.30506-7.0562,0.92102-9.2154-1.2557s-1.7026-6.3706-1.3408-10.641c2.1953-25.914,4.3667-51.544,6.5125-76.873,0.3618-4.2707,0.355-7.5794,3.3839-10.471z"/>
						<path data-idx=9  class="sticker" d="m222.93,64.862c5.5123-12.138,10.964-24.142,16.352-36.006,0.9085-2.0004,1.1111-3.1728,3.5115-4.717,2.4005-1.5442,6.2369-1.2754,9.7485-1.271,21.308,0.02535,42.381,0.05409,63.208,0.0786,3.5116,0.004,6.9778-0.0437,8.5334,1.162,1.5555,1.2057,1.0403,2.8518,0.5599,4.8522-2.9151,12.138-5.7986,24.142-8.6478,36.006-0.4804,2.0004-0.2714,2.812-2.6272,4.6669s-6.6932,1.3255-10.633,1.3211c-23.905-0.02535-47.547-0.05409-70.912-0.0786-3.9395-0.004-7.0139,0.26119-9.0672-0.9565s-0.9347-3.0573-0.0261-5.0577z"/>
						<path data-idx=10 class="sticker" d="m53.937,135.81c12.882,2.1204,25.622,4.2176,38.212,6.2901,2.1229,0.34945,3.196,0.44265,5.3204,2.6209s2.1316,6.2202,2.6733,10.117c3.2867,23.643,6.5372,47.026,9.7497,70.135,0.54165,3.8964,1.3459,8.7593,0.26209,9.8545s-2.8526,0.52109-4.9603-0.13567c-12.79-3.9852-25.438-7.9266-37.939-11.822-2.1077-0.65676-3.6832-1.0165-5.2224-2.5993-1.5393-1.5828-2.2144-6.5491-2.7712-10.138-3.3788-21.778-6.7204-43.317-10.023-64.603-0.55682-3.5891-1.2086-7.8932,0.0069-9.1946,1.2155-1.3015,2.5685-0.87363,4.6914-0.52418z"/>
						<path data-idx=11 class="sticker" d="m743.75,140.68c1.6239-1.8066,2.8094-1.9296,4.7461-2.2347,11.752-1.851,23.375-3.6817,34.861-5.4909,1.9368-0.30506,3.0539-0.71225,4.363,0.3618s0.1277,5.6328-0.5321,9.0877c-4.0032,20.964-7.9631,41.697-11.876,62.188-0.6598,3.4549-1.1553,7.243-2.5752,9.2154-1.42,1.9724-3.2492,2.3269-5.1717,2.9157-11.666,3.5729-23.203,7.1067-34.606,10.599-1.9225,0.58882-2.6535,1.0462-4.2352,0.14898-1.5817-0.89719-0.2412-5.8598,0.4043-9.5985,3.9175-22.686,7.7914-45.122,11.62-67.296,0.6456-3.7387,1.377-8.0898,3.0008-9.8964z"/>
						<path data-idx=12 class="sticker" d="m324.66,385.47c-1.8175,0.6478-1.4812,2.8483-1.1231,4.5898,2.1726,10.568,4.322,21.019,6.4453,31.348,0.3581,1.7415,0.6415,2.7179,2.3438,4.0527,1.7022,1.3349,6.1442,1.4567,9.851,1.5991,22.493,0.86417,44.739,1.719,66.724,2.5635,3.7068,0.1424,7.3136,0.5588,9.3139-0.6958,2.0004-1.2546,1.9613-2.3275,2.0386-4.0527,0.46897-10.469,0.93309-20.822,1.3916-31.055,0.077-1.7253,0.267-3.4058-1.5259-4.2969-1.7928-0.891-6.5266-1.1963-10.669-1.355-25.135-0.96289-49.993-1.9152-74.56-2.8564-4.1423-0.1587-8.4121-0.4891-10.23,0.1587z"/>
						<path data-idx=13 class="sticker" d="m321.21,282.26c2.9653-2.9438,6.1672-2.3064,10.605-2.1661,26.926,0.85189,53.556,1.6944,79.874,2.5271,4.4374,0.14039,8.6384,0.0908,11.086,2.5872,2.4477,2.4964,2.0257,5.6659,1.9254,9.5818-0.6085,23.762-1.2102,47.262-1.805,70.487-0.1003,3.9159,0.2613,7.1432-2.3466,9.4615-2.6079,2.3182-6.438,2.0056-10.68,1.8652-25.739-0.852-51.196-1.6944-76.354-2.5271-4.2419-0.1404-7.416,0.07-10.289-2.8279-2.8728-2.8981-2.6274-5.4252-2.7226-9.3412-0.5777-23.762-1.1501-47.262-1.7148-70.487-0.095-3.9159-0.5436-6.2169,2.4218-9.1606z"/>
						<path data-idx=14 class="sticker" d="m444.42,284.02c2.8101-2.9377,6.0098-2.9175,10.168-3.2495,25.23-2.0141,50.183-4.0062,74.843-5.9748,4.1579-0.33194,7.0275-0.95197,9.8532,1.8868s1.9742,4.7694,1.651,8.5954c-1.9612,23.216-3.9007,46.176-5.8176,68.868-0.3232,3.826-0.024,7.0375-2.7516,9.8533-2.728,2.8157-6.167,2.5506-10.142,3.0136-24.117,2.809-47.969,5.5879-71.541,8.3333-3.9745,0.463-6.2724,1.31-9.1981-1.3889-2.9258-2.6988-2.4459-5.1362-2.3061-9.0933,0.84783-24.011,1.6871-47.758,2.5157-71.226,0.1398-3.957-0.085-6.6797,2.7254-9.6174z"/>
						<path data-idx=15 class="sticker" d="m230.98,420.73c-2.3389-1.5045-2.7751-2.417-3.6621-4.1382-5.3824-10.444-10.706-20.773-15.967-30.981-0.887-1.7212-1.5594-3.6391-0.3662-4.3091s5.8024-0.5371,9.8511-0.3784c24.567,0.96292,48.864,1.9152,72.876,2.8564,4.0487,0.1587,9.2781,0.1852,11.145,1.5747,1.867,1.3895,1.9205,2.3763,2.3803,4.1138,2.79,10.543,5.5494,20.97,8.2764,31.274,0.4598,1.7375,1.0339,3.3729-0.2075,4.3579-1.2415,0.985-5.656,0.5046-9.2774,0.3296-21.974-1.0618-43.707-2.1115-65.186-3.1494-3.6214-0.175-7.5244-0.046-9.8633-1.5503z"/>
						<path data-idx=16 class="sticker" d="m123.74,255.31c1.6258-1.0009,3.2917-0.11351,5.8527,0.76617,15.54,5.3379,30.909,10.617,46.098,15.834,2.561,0.87968,4.502,1.2238,6.5338,3.7883,2.0317,2.5646,1.9154,6.4841,2.2985,10.301,2.3246,23.159,4.6235,46.064,6.8956,68.701,0.3831,3.8167,0.8107,8.1779-0.5108,9.109-1.3214,0.931-3.3343,0.028-5.8315-1.128-15.152-7.0169-30.139-13.956-44.949-20.814-2.4972-1.1563-4.4771-1.7695-6.3422-4.3204-1.8652-2.5508-2.0431-6.2287-2.4901-9.7687-2.712-21.481-5.3941-42.725-8.0449-63.72-0.44694-3.54-1.1363-7.7463,0.4895-8.7472z"/>
						<path data-idx=17 class="sticker" d="m199.97,278.95c2.5518-2.4501,6.1071-1.9755,10.424-1.8803,26.196,0.5781,52.103,1.1498,77.708,1.7148,4.317,0.0953,7.9109-0.31067,10.845,2.5722,2.9344,2.8829,2.4168,5.5255,2.5722,9.4314,0.9434,23.701,1.8757,47.141,2.7979,70.307,0.1554,3.9059,0.895,7.3687-1.4591,9.6119-2.3542,2.2432-6.3177,1.805-10.439,1.6546-25.009-0.9126-49.743-1.8156-74.188-2.7076-4.1215-0.1504-7.4178,0.4309-10.319-2.3165-2.901-2.7473-2.7477-5.8363-3.0987-9.6871-2.1293-23.366-4.2364-46.476-6.3176-69.314-0.351-3.8508-1.0777-6.9362,1.4741-9.3863z"/>
						<path data-idx=18 class="sticker" d="m334.23,433.2c-1.1563,0.6721-1.1116,1.7771-0.839,3.1117,1.6541,8.0983,3.2898,16.108,4.9065,24.023,0.2726,1.3346,0.6249,2.1097,2.0497,3.2392,1.4249,1.1295,5.3314,1.0762,8.613,1.2319,19.913,0.94536,39.607,1.8798,59.07,2.8038,3.2816,0.1557,7.3153,0.5216,8.613-0.2549s1.4019-1.9471,1.4868-3.2817c0.51541-8.0983,1.0258-16.107,1.5293-24.023,0.085-1.3346,0.1353-2.1521-1.1894-3.0692-1.3247-0.9172-5.8341-1.2461-9.4733-1.4019-22.082-0.94497-43.922-1.8802-65.506-2.8037-3.6392-0.1558-8.1045-0.2474-9.2608,0.4248z"/>
						<path data-idx=19 class="sticker" d="m558.72,274.8c2.7326-2.7043,5.7605-2.7384,9.6198-3.0434,23.418-1.851,46.578-3.6817,69.467-5.4909,3.8592-0.30506,7.179-0.70308,9.1941,1.128,2.015,1.8311,1.3621,5.3632,0.8513,9.0664-3.0995,22.471-6.1646,44.694-9.1941,66.657-0.5108,3.7032-0.5222,6.8953-3.1924,9.4921-2.6702,2.5967-5.718,2.4262-9.407,2.8306-22.385,2.4534-44.523,4.8807-66.402,7.2786-3.689,0.4044-7.0593,0.9965-8.9813-0.9151-1.9219-1.9117-1.4046-5.4768-1.0641-9.2793,2.0662-23.073,4.1099-45.893,6.1294-68.445,0.3405-3.8025,0.247-6.575,2.9796-9.2792z"/>
						<path data-idx=20 class="sticker" d="m668.12,261.23c13.969-4.5416,27.784-9.0329,41.437-13.472,2.3021-0.74844,3.8722-1.4052,5.2462-0.32988s0.4824,4.9163-0.1064,8.3322c-3.5732,20.727-7.1062,41.227-10.599,61.486-0.5888,3.4158-1.0139,6.8982-2.8306,9.226-1.8166,2.3279-3.3981,2.9938-5.6292,3.9799-13.538,5.9835-26.928,11.902-40.16,17.75-2.2311,0.986-3.6535,1.9555-5.0759,1.0002-1.4224-0.9552-0.5817-5.349-0.064-9.0025,3.1426-22.169,6.2502-44.095,9.3218-65.764,0.5179-3.6535,0.7804-7.3866,2.7456-9.7262s3.4124-2.7313,5.7145-3.4797z"/>
						<path data-idx=21 class="sticker" d="m243.67,428.39c21.588,1.0097,42.939,2.008,64.04,2.9949,3.5578,0.1664,8.2475,0.385,9.5688,1.2638s1.7913,1.9046,2.1347,3.2392c2.0833,8.0984,4.1448,16.107,6.1809,24.023,0.3434,1.3346,0.8717,2.5629-0.4141,3.4091-1.2859,0.8463-4.9915,0.262-8.2095,0.096-19.526-1.0096-38.838-2.008-57.923-2.9949-3.2179-0.1664-7.1199-0.278-8.7616-1.3063-1.6418-1.0283-2.2586-1.8621-2.9418-3.1967-4.1462-8.0981-8.2458-16.108-12.298-24.023-0.6832-1.3346-0.6161-2.6411,0.5417-3.1544,1.1578-0.51335,4.5242-0.51705,8.082-0.35065z"/>
						<path data-idx=22 class="sticker" d="m730.08,241.44c11.687-3.7666,23.246-7.4919,34.67-11.173,1.9261-0.62075,3.0098-1.1862,4.0757-0.37245,1.0658,0.8137,0.4256,4.8454-0.2129,8.0129-3.8744,19.221-7.7057,38.23-11.493,57.016-0.6385,3.1676-0.9051,6.5583-2.5539,8.6089-1.6489,2.0505-3.0789,2.5326-4.9376,3.352-11.278,4.9719-22.433,9.8892-33.456,14.749-1.8587,0.8194-2.5768,1.4924-3.8309,0.6704s-0.603-4.9447-0.032-8.3109c3.465-20.426,6.8929-40.627,10.28-60.592,0.5711-3.3662,1.083-7.2342,2.5646-8.9919s3.0008-2.3482,4.927-2.9689z"/>
						<path data-idx=23 class="sticker" d="m69.557,236.03c12.67,4.2409,25.2,8.4351,37.583,12.58,2.088,0.6989,3.2313,0.66684,5.0583,2.883,1.827,2.2161,2.1316,6.2377,2.5947,9.7497,2.8096,21.31,5.5883,42.386,8.3344,63.216,0.46303,3.512,1.2157,7.44,0.2883,8.4655-0.92744,1.0254-2.9179,0.2184-4.9272-0.7077-12.192-5.6193-24.251-11.176-36.168-16.669-2.0093-0.926-3.4312-1.3343-5.1107-3.5382-1.6795-2.2038-2.0006-5.8096-2.5423-9.0944-3.2867-19.932-6.5372-39.645-9.7497-59.127-0.54164-3.2848-1.1616-7.3796-0.05241-8.2296,1.1092-0.84991,2.6034-0.22715,4.6914,0.47175z"/>
					</g>
				</svg>
			</div>
		`);

		this._stickerElementsSorted = Array.from(this.element.querySelectorAll('.sticker'))
			.sort((a, b) => a.dataset.idx - b.dataset.idx)
		;
		
		// set click handler on each sticker
		this._stickerElementsSorted.forEach(el => {
			el.addEventListener('click', evt => {
				let idx = evt.target.dataset.idx;
				this._state.stickerValues[idx] = getSelectedColor();
				this._render();
				onStickerClick();
			});
		});

		this._render();
	}

	_render(state) {
		if(!state) state = this._state;
		for(let i=0; i<state.stickerValues.length; i++) {
			if(this._stickerElementsSorted[i].dataset.val != state.stickerValues[i]) {
				this._stickerElementsSorted[i].dataset.val = state.stickerValues[i];
			}
		}
	}

	setStickersToSolved() {
		this.setStickers('urfuflubrulbdfrdlfdrbdbl'.split(''));
	}
	setStickersToEmpty() {
		this.setStickers('........................'.split(''));
	}
	setStickers(stickerValues) {
		this._state.stickerValues = stickerValues;
		this._render();
	}
	getStickers() {
		return this._state.stickerValues;
	}
};
